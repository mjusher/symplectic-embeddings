# Symplectic Embeddings of Ellipsoids

This is a program for studying when a four-dimensional ellipsoid symplectically embeds into an ellipsoid or polydisk.  The file **seep.jar** is an executable jar which should run on any machine with Java installed; the file is rather large because all necessary libraries (including JFreeChart for plots) are packaged into it.  The main mathematical ingredients are in the source file *DomainTools.scala*, and the user interface is coded in *UI.scala*. The DomainTools file also contains some potentially-useful functions that don't appear in the executable: for instance one can consider embeddings from an arbitrary rational concave polygonal domain to an arbitrary rational convex polygonal domain, or one can graph _c<sub>P(1,b)</sub>(a)_ as a function of _b_ instead of as a function of _a_.

For any domain _X_ in R<sup>4</sup> and any positive number _a_ we define _c<sub>X</sub>(a)_ to be he infimal number _d_ such that the ellipsoid _E(1,a)_ embeds in _dX_, where _dX_ is the result of dilating _X_ by d<sup>1/2</sup> (so increasing its symplectic capacities by a factor of _d_).  The program provides two ways of probing the function _c<sub>X</sub>_ for _X_ equal to an ellipsoid _E(1,b)_ or a polydisk _P(1,b)_, specified by the user at the top of the dialog box.  The basis for this is a Cremona reduction algorithm (based ultimately on [Li--Li](https://arxiv.org/abs/math/0108227) and [McDuff](https://arxiv.org/abs/0801.4665) and used for instance in [Cristofaro-Gardiner--Frenkel--Schlenk](https://arxiv.org/abs/1604.06206)) which, given rational _a,b,t_, determines rigorously and in finite time whether or not _t>c<sub>X<sub>(a)_ for _X_ equal to either _E(1,b)_ or _P(1,b)_.

On the left of the dialog box, the user can graph the function _c<sub>X</sub>_ over a prescribed range of _a_ values.  This is done by, for each member of a set of evenly spaced values of _a_, applying the Cremona reduction algorithm several times to find (by successive bisections) a small interval whose left endpoint is less than _c<sub>X</sub>(a)_ and whose right endpoint is greater than or equal to _c<sub>X</sub>(a)_.  The right endpoints of these intervals are then plotted.  The parameter "precision" is inversely proportional both to the distance between successive _a_ values and to the width of the interval that the bisection algorithm finds. You might choose 1 to get a quick sense of what the graph looks like, and then 3 or 5 to zero in more carefully on interesting features.   If "save?" is checked the file will be saved as "graph.eps."  The time required to make the graph is related both to the precision that you select and to the amount of time that the Cremona reduction algorithm takes for each value of _a_; the latter tends to be largest when _c<sub>X</sub>(a)_ is slightly larger than the volume bound.

The options on the right attempt to give an exact calculation of _c<sub>X</sub>(a)_ for a specific rational number _a_ entered by the user, as well as information about obstructions coming from exceptional spheres and (if the appropriate box is checked) ECH capacities.  To find this, the program first uses the bisection method from the previous paragraph to find an interval of length less than 10<sup>-8</sup> that contains _c<sub>X</sub>(a)_.  If the left endpoint of this interval is above the volume bound, then it corresponds to a value of _t_ for which an embedding of _E(1,a)_ into _tX_ is obstructed by the requirement that the corresponding symplectic form on a blowup of _CP<sup>2</sup>_ be positive on some exceptional sphere.  In this case the program iteratively finds a strictly increasing sequence of obstructions given by exceptional spheres; this sequence eventually terminates and the program reports this maximal obstruction (which is then equal to _c<sub>X</sub>(a)_) as well as the exceptional sphere giving the maximal obstruction.  If the ECH box is checked, the program also calculates some of the ECH capacities of _E(1,a)_ and of _X_, and checks whether the largest ratio that it finds is realized by an embedding, in which case _c<sub>X</sub>(a)_ is equal to this largest ratio.

If either ECH capacities or an exceptional sphere obstruction are reported then the embedding that is stated in the output is optimal; otherwise the stated embedding gives an upper bound for _c<sub>X</sub>(a)_ that is accurate to within 1/180,000,000 (and is extremely close to the volume bound). 

The exceptional sphere algorithm typically doesn't take very long, though this is partly because I have prevented it from running in the hardest case where the left endpoint of the interval found by bisection is less than the volume bound (as otherwise there would be a danger of getting caught in an infinite loop).  It takes somewhat more time to compute a large number of ECH capacities, which is why I made this function optional.  I typically start to notice a pause when I ask for 1000 ECH capacities; if I ask for 5000 it may take close to a minute.